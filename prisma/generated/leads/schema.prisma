generator client {
  provider = "prisma-client-js"
  output   = "./generated/leads"
}

datasource db {
  provider = "mysql"
}

model Lead {
  leadId                Bytes                  @id @db.Binary(16)
  ipAddress             Bytes?                 @db.Binary(16)
  schoolName            String                 @db.VarChar(50)
  emailAddress          String                 @db.VarChar(255)
  firstName             String?                @db.VarChar(255)
  lastName              String?                @db.VarChar(255)
  telephoneNumber       String?                @db.VarChar(255)
  emailOptIn            Boolean                @default(false)
  smsOptIn              Boolean                @default(false)
  city                  String?                @db.VarChar(191)
  provinceCode          String?                @db.Char(3)
  countryCode           String?                @db.Char(2)
  referrer              String?                @db.Text
  browserName           String?                @db.VarChar(191)
  browserVersion        String?                @db.VarChar(191)
  os                    String?                @db.VarChar(191)
  mobile                Boolean?
  gclid                 String?                @db.VarChar(100)
  msclkid               String?                @db.VarChar(1024)
  created               DateTime               @default(now()) @db.DateTime(6)
  updated               DateTime               @updatedAt @db.DateTime(6)
  nonce                 Bytes?                 @db.Binary(16)
  // country               Country?               @relation(fields: [countryCode], references: [code], onDelete: Cascade, map: "FK_leads_general.countries")
  // province              Province?              @relation(fields: [countryCode, provinceCode], references: [countryCode, code], onDelete: Cascade, map: "FK_leads_general.provinces")
  // school                School                 @relation(fields: [schoolName], references: [name], onDelete: Cascade, map: "FK_leads_general.schools")
  marketingParameterSet MarketingParameterSet?
  courses               LeadsOnCourses[]
  fbFields              Json?

  @@index([schoolName])
  @@index([nonce])
  @@index([countryCode, provinceCode], map: "countryCodeProvinceCode")
  @@map("leads")
}

model LeadsOnCourses {
  leadId     Bytes  @db.Binary(16)
  courseCode String @db.Char(2)
  lead       Lead   @relation(fields: [leadId], references: [leadId], onDelete: Cascade, map: "FK_leads_courses_leads")
  // course     Course @relation(fields: [courseCode], references: [code], map: "FK_leads_courses_general.courses")

  @@id([leadId, courseCode])
  @@index([courseCode], map: "courseCode")
  @@map("leads_courses")
}

model MarketingParameterSet {
  leadId   Bytes   @id @db.Binary(16)
  source   String? @db.VarChar(1024)
  medium   String? @db.VarChar(1024)
  campaign String? @db.VarChar(1024)
  content  String? @db.VarChar(1024)
  term     String? @db.VarChar(1024)
  lead     Lead    @relation(fields: [leadId], references: [leadId], onDelete: Cascade, map: "FK_marketing_parameter_sets_leads")

  @@map("marketing_parameter_sets")
}
